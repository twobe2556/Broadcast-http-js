!function(e,s){"function"==typeof define&&define.amd?define(["jquery"],s):"object"==typeof module&&module.exports?module.exports=s(require("jquery")):e.Broadcast=s(e.jQuery)}("undefined"!=typeof self?self:this,function(e){"use strict";var s=function(e,s={}){this.open=!1,this.channelActive=e,this.port=n(s.port,s.port,"9000"),this.ssl=n(s.ssl,!0===s.ssl?"wss":"ws","ws"),this.serverAddress=this.ssl+"://"+n(s.serverAddress,s.serverAddress,"")+n(s.serverAddress,":"+this.port,""),this.channels={},t(this)};let t=function(e){let s=e;s.socket=new WebSocket(s.serverAddress+"?channel="+s.channelActive),s.socket.onopen=e=>{console.log("Connected to the server"),s.open=!0},s.socket.onclose=e=>{console.log("Disconnected from the server"),s.open=!1},s.socket.onmessage=e=>{let t=JSON.parse(e.data),{channel:n,event:o,data:r}=t,i=s.channels[n],c={channel:n,event:o};"string"==typeof r?c.message=r:"object"==typeof r&&null!==r&&Object.keys(r).forEach(e=>{c[e]=r[e]}),i&&i.events[o]&&i.events[o].forEach(e=>{e(c)})}};s.prototype.sendMessage=function(e,s,t){this.open&&this.socket.send(JSON.stringify({channel:e,event:s,data:t}))},s.prototype.subscribe=function(e){let s=new o(this,e);return this.channels[e]=s,s};let n=function(e,s,t){return void 0==e||null==e||""==e?t:s};class o{constructor(e,s){this.pusher=e,this.name=s,this.events={}}bind(e,s){this.events[e]?this.events[e].push(s):this.events[e]=[s]}}return s});